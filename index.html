<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rekap Keterlambatan Kas</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background-color: #f4f4f4; }
    </style>
</head>
<body>

    <h2>Daftar Keterlambatan Kas Himpunan</h2>
    <p>Data di bawah ini tersinkronisasi secara otomatis.</p>

    <table id="tabel-data">
        </table>

    <script>
        // GANTI URL DI BAWAH INI DENGAN LINK CSV DARI GOOGLE SHEETS ANDA
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTrif12Yy8eQx-OCnB8yZTwoumpGFUdPtYJNVftjQ4_4kZEzfsrcpJe7w6FY-_iGmCbGxqRJqC3ylMh/pub?gid=0&single=true&output=csv'; 

        fetch(csvUrl)
            .then(response => response.text())
            .then(data => {
                const rows = data.split('\n');
                let tableHTML = '';
                
                rows.forEach((row, index) => {
                    // Memisahkan data berdasarkan koma (CSV)
                    const columns = row.split(','); 
                    
                    if (columns.length > 1) { // Menghindari baris kosong
                        tableHTML += '<tr>';
                        columns.forEach(col => {
                            if (index === 0) {
                                // Baris pertama dijadikan Header (th)
                                tableHTML += `<th>${col.replace(/"/g, '')}</th>`;
                            } else {
                                // Baris selanjutnya dijadikan Data (td)
                                tableHTML += `<td>${col.replace(/"/g, '')}</td>`;
                            }
                        });
                        tableHTML += '</tr>';
                    }
                });
                
                document.getElementById('tabel-data').innerHTML = tableHTML;
            })
            .catch(error => console.error('Gagal mengambil data:', error));
    </script>

</body>
</html>
